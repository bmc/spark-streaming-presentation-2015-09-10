<section data-background="images/bg2.jpg">
  <h3>Computing an Average (again)</h3>

  <pre>
    <code class="scala" data-trim>
// RDDs

var data = sc.textFile(...).split("\t")
data.map { x => (x(0), (x(1), 1))) }
    .reduceByKey { case (x, y) => (x._1 + y._1, x._2 + y._2) }
    .map { x => (x._1, x._2(0) / x._2(1)) }
    .collect()

// DataFrames
val df = sqlContext.read.parquet("...")
df.groupBy("name").agg("name", avg("age")).collect()
    </code>
  </pre>
</section>
